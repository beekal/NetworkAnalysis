---
title: "R Sample SNA"
output: html_document
---

SNA Using Matrix Algebra in R
------------------------------------

```{r}
# specify the adjacency matrix
A <- matrix(c(0,1,1,1,1,0,1,0,1,1,0,0,1,0,0,0 ),4,4, byrow= TRUE)
A
EV <- eigen(A) # compute eigenvalues and eigenvectors
max(EV$values)  # find the maximum eigenvalue
EV
# get the eigenvector associated with the largest eigenvalue
centrality <- data.frame(EV$vectors[,1]) 
names(centrality) <- "Centrality"
print(centrality)
```

REF : http://www.econometricsense.blogspot.com/2012/04/introduction-to-social-network-analysis.html

Key Actor Analysis
-----------------------

**Critical Gatekeeper** (Conway, 2009).
An individual that is central to the functioning of the network.
If we assume a linear relationship between eigenvector centrality and betweeness and regress betweeness on eigenvector centrality, the residuals can be used to identify key players (Conway, 2009).   A vertex or individual with higher levels of betweenness and lower EV centrality may be a 'critical gatekeeper  or an individual that is central to the functioning of the network.

*These people connect people to a network that otherwise would be isolated from the core.*

**Individuals with Unique acess to the critical gatekeepers of the network**
lower levels of betweeness and higher EV centrality
*These people are highly likely at the core of a network and are well connected.*

```{r}
library(igraph)
G<-graph.adjacency(A, mode=c("undirected"))               
# convert adjacency matrix to an igraph object


cent<-data.frame(bet=betweenness(G),eig=evcent(G)$vector) 
# calculate betweeness & eigenvector centrality 
cent
lm(eig~bet,data=cent)
lm(eig~bet,data=cent)$residuals
res<-as.vector(lm(eig~bet,data=cent)$residuals)           
# calculate residuals
res
cent<-transform(cent,res=res)                             
# add to centrality data set
cent
write.csv(cent,"r_keyactorcentrality.csv")                
# save in project folder
 
plot(G, layout = layout.fruchterman.reingold)             
# network visualization
 
as.vector(rownames(cent))
cent
evcent(G)
evcent(G)$vector

```

**More connected the node is more prominent the node becomes**
i.e Higher the eigen vector value of the node, the more prominent it is.

```{r}

# create vertex names and scale by centrality
plot(G, layout = layout.fruchterman.reingold, vertex.size = 20*evcent(G)$vector, vertex.label = as.vector(rownames(cent)), main = 'Network Visualization in R')
```

**Key Actor Analysis**

```{r}
 
# key actor analysis - plot eigenvector centrality vs. betweeness
# and scale by residuals from regression: eig~bet
# install.packages('ggplot2') 
library(ggplot2)
 
p<-ggplot(cent,aes(x=bet,y=eig,label=rownames(cent),colour=res,              size=abs(res)))+xlab("Betweenness Centrality")+ylab("Eigenvector Centrality")
pdf('key_actor_analysis.pdf')
p+geom_text()
 
dev.off()
```

**Terror Network :**
People who have 2 or more friends that are on the suspect list.
i.e if people call 2 or more friends on the suspect list,possible suspect.


You can also embed plots, for example:

# ```{r, echo=FALSE}
# plot(cars)
#```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
